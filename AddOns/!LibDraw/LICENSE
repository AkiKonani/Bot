This version is based on https://gist.github.com/benphelps/7f88f181978267edf899.
Most code seems to be copyrighted by its author(s).
